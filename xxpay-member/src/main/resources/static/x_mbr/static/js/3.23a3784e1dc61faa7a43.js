webpackJsonp([3],{"5kAh":function(t,e){t.exports="data:image/png;base64,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"},F2Wx:function(t,e){},J6nm:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAEp0lEQVR4Xu1bXXbaVhD+BpDyGGcFcV97YiArCN6Bs4GCVhCzgjorsLMC4W6gzgpCVhCQe/pasoLixwrQ9IxAIPRndNFF2JbO4QXunTvzaWbu/EF44Q+9cPlRAVBpwAtHoDKBF64A6U5w9sfZBzB1mOkUgHySH+I7s+t8KQNI97b5CUwXGWdPiHgC4qHx2/33pHUxE5jbZxcLql1TltARSjX2Pjas+7tDgiB8elT7c9czGZjU2etH+dwCwB00rwG63JXoeh3P3pvW36Pc+/bY4Nq/tkHGj/wk+MbsOf1g3xoA125egug6TJAZPwEWwVKFI/DEtO4H+RnZf4drn/UYvokmPgR05HcivN1awNw3LedGvvMBYLt9OiP+Z/NG8UBYXBjWX8P92Syfwsx+12HU70B4HXBjMP1C1mjiA+DazQGIuv6PjAdg1jm0SuuGyTcZGMM1CMy3puX0lgAMWv8COPHlZ/78ynKudDNUBv3/7OYVEf2+Ontq9sZvKOZMSnBohwIjSVby7YPq3wImzN74WUeH7qDF6xuAF+cVAJUGVCbwtHwA2+2TeX3RaizqY7JG07wO9En7gJUXF4d9wsxfX1lOViKUiM2TBSAs/DJgWwYye2uAqNQMkjLiNRhj0xq38xLVvT4uPMYGqKNkAnZrBEJLIl5D8oQgF5hjftpAY6RCVCcAq7TXDiLVfUN134dg3m6gMVnnAjoF2Ie2ZHugmgi/fogX50UmaUcb9SUJD/asolPvowQgWXg1p/eYBh4dAIlVKebvpuV0HhNG5fejAsAdtMTet682Vvf4uwByNACkCC9XVVu89S7CqKwpBIDVPS31xInB1M97lSYK79/P+outBQHQHILow7Kihgnx7OMuJTU/CCOW0DYefGnw+EkaUhQAm5ri8pQp2OtnXVnZwvMX03Lyl+cVbKAQAEQYFzyKlp+J+MroOp+jfGUJr5rkKMjubykEACEULawEDDFwZzJZgV9YleClo5Og9no9vjYTCAhHqq7h80bgmbWE3PDT2RgzQXKikOOrvv1CNSBgwrU3DjHCWFC8SBS+rF5EYSawVnnpMkk7LdSFefQNHcjjazeB4IA8nduyGzGFa0DIFG5A9Cnz7StWdR7VqBwLNgWR+uKtaqEx7Tw3qL4kLdAc46fxFCqq/vQLIqs7WTrD4pxGZm/8PgeAmUtjDcnN3bgsRx3Y48vx7qAlMwVyBU/9DrHuxkgsty+5+1xKVTjcfi9jnCaspqUAEESKQSGyKBNToVMaACrM6thTAVC1x6v5gO0BiejYSDA9pcP+yqaZOCLjBwd2axokL2XH5jpB2krXGQ+mNT6Jj8n55azZ+S41PZ3MFk07rbucPCgJTGvsWYee/y1a6Eh2ummwAtgalFyaQcKorFR45UOcOjEqVWCz69zqYj6Lrnvb7GYNdbNMuwPSAt8ep42OyuZKYRMzO/31++ixysPSvF1xTh6XR+0mNmCc8SrKiO/zFF2EdRn8rsO7zByXD8soWaKHWmelPul/mJCq72ry+tBm4JstkPmHCTHRGrxh2kyBtorQocFQPa8CQBW557Kv0oDn8iZV5ag0QBW557Lvf27QtVWa+X5PAAAAAElFTkSuQmCC"},pa6n:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o("CJJO"),i=o("s0MJ"),a=o("WBIT"),n=o("so+s"),c=o.n(n),r=o("J6nm"),l=o.n(r),m=o("5kAh"),d=o.n(m),u={data:function(){return{active:0,htmlProportion:"",htmlWidth:"",htmlheight:"",memberDetail:{},mchSrc:"",cardSrcBox:"",cardSrc:"",bgImgUrl:c.a,pay:l.a,recharge:d.a,couponList:[],couponRefreshing:!1,couponLoading:!1,couponLoadedAll:!1,couponIsGetMore:!0,goodsList:[],goodsRefreshing:!1,goodsLoading:!1,goodsLoadedAll:!1,goodsIsGetMore:!0,page:1,limit:10}},created:function(){this.htmlWidth=document.documentElement.clientWidth||document.body.clientWidth,this.htmlheight=document.documentElement.clientHeight||document.body.clientHeight,this.htmlProportion=this.htmlWidth/750;var t=Object(i.getUrlKey)("access_token");t&&window.localStorage.setItem(s.y,t),this.getMemberDetails(),this.getMchCouponList()},watch:{cardSrc:function(t,e){this.cardSrc&&(this.cardSrcBox={backgroundImage:"url("+this.cardSrc+")"})}},methods:{getMemberDetails:function(){var t=this;Object(s.d)().then(function(e){t.memberDetail=e.data,t.mchSrc=void 0==t.memberDetail.mchPhotoId?null:t.getPic(t.memberDetail.mchPhotoId),t.memberDetail.backgroundPictureId?t.cardSrc=t.getPic(t.memberDetail.backgroundPictureId):t.cardSrc=t.bgImgUrl}).catch(function(t){console.log(t)})},couponRefresh:function(){this.couponRefreshing=!0,this.couponIsGetMore=!0,this.$refs.container.scrollTop=0,this.page=1,this.getMchCouponList(),np},couponLoad:function(){this.couponLoading=!0,this.page=Math.floor(this.couponList.length/this.limit)+1,this.couponIsGetMore?this.getMchCouponList():this.couponLoadedAll=!0},getMchCouponList:function(){var t=this,e=this;Object(s.h)(e.page,e.limit).then(function(o){t.couponLoading=!1;var s=e.setCoupons(o.data);e.couponList=e.couponRefreshing?s:e.couponList.concat(s),s.length<e.limit?(e.couponIsGetMore=!1,e.couponLoadedAll=!0):e.couponLoadedAll=!1,e.couponRefreshing=!1}).catch(function(t){e.couponRefreshing=!1,console.log(t)})},setCoupons:function(t){var e=[];return t.forEach(function(t){1==t.validateType?t.validateEnd="有效期：领取后"+t.validateDay+"天":2==t.validateType&&(t.validateEnd="有效期："+i.dateUtils.format2Datetime(t.endTime)),e.push({couponId:t.couponId,payAmountLimit:"满"+t.payAmountLimit/100+"减"+t.couponAmount/100,couponAmount:"￥"+t.couponAmount/100,validateEnd:t.validateEnd,totalNum:"剩余"+(t.totalNum-t.receiveNum)+"张"})}),e},getCoupon:function(t){var e=this,o=this.$loading({}),i=this,n=i.couponList[t];Object(s.a)(n.couponId).then(function(t){o.close(),0==t.code?(i.page=1,i.couponRefreshing=!0,i.couponIsGetMore=!0,e.getMchCouponList(),a.Toast.text({duration:1e3,message:"恭喜！抢到了"})):16003==t.code&&a.Dialog.confirm({message:t.msg,showCancelButton:!0,confirmButtonText:"去卡包"}).then(function(){console.log("confirmed")}).catch(function(){console.log("canceled")})}).catch(function(t){o.close(),console.log(t)})},goodsRefresh:function(){this.goodsRefreshing=!0,this.goodsIsGetMore=!0,this.$refs.container.scrollTop=0,this.page=1,this.getMchPointsGoodsList()},goodsLoad:function(){this.goodsLoading=!0,this.page=Math.floor(this.goodsList.length/this.limit)+1,this.goodsIsGetMore?this.getMchPointsGoodsList():this.goodsLoadedAll=!0},getMchPointsGoodsList:function(){var t=this,e=this;Object(s.j)(e.page,e.limit).then(function(o){console.log(o),t.goodsLoading=!1;var s=e.setPointsGoods(o.data);e.goodsList=e.goodsRefreshing?s:e.goodsList.concat(s),s.length<e.limit?(e.goodsIsGetMore=!1,e.goodsLoadedAll=!0):e.goodsLoadedAll=!1,e.goodsRefreshing=!1}).catch(function(t){e.goodsRefreshing=!1,console.log(t)})},setPointsGoods:function(t){var e=[];return t.forEach(function(t){t.stockNum=1==t.stockLimitType?"不限库存":null==t.stockNum?"剩余0份":"剩余"+t.stockNum+"份",t.validateEnd="有效期："+i.dateUtils.format2Datetime(t.endTime),e.push({goodsId:t.goodsId,goodsName:t.goodsName,points:t.points+"积分",goodsPrice:"价值"+t.goodsPrice/100+"元",imgPath:t.imgPath,validateEnd:t.validateEnd,stockLimitType:t.stockLimitType,stockNum:t.stockNum,status:t.status})}),e},getGoods:function(t){var e=this,o=this.$loading({}),i=this,n=i.goodsList[t];Object(s.b)(n.goodsId).then(function(t){o.close(),0==t.code&&(i.page=1,i.goodsRefreshing=!0,i.goodsIsGetMore=!0,e.getMchPointsGoodsList(),a.Toast.text({duration:1e3,message:"兑换成功"}))}).catch(function(t){o.close(),console.log(t)})},jumpmemberCards:function(){this.$router.push({path:"/member/memberCard/detail",query:{mchId:this.memberDetail.mchId}})},change:function(t){0==t?(this.page=1,this.couponRefreshing=!0,this.couponIsGetMore=!0,this.getMchCouponList()):1==t&&(this.page=1,this.goodsRefreshing=!0,this.goodsIsGetMore=!0,this.getMchPointsGoodsList())},jump:function(t){this.$router.push({path:t,query:{memberId:this.memberDetail.memberId}})}}},g={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bg-white"},[s("div",{staticClass:"member-content",style:{height:t.htmlheight-200*t.htmlProportion-1+"px"}},[s("div",{staticClass:"member-content-card"},[s("div",{staticClass:"member-card-box",style:{height:590*t.htmlProportion+"px"}},[s("div",{staticClass:"member-card",style:[{height:350*t.htmlProportion+"px"},t.cardSrcBox],on:{click:t.jumpmemberCards}},[s("div",[s("div",{staticClass:"member-card-head"},[s("div",{staticClass:"member-img-head"},[t.mchSrc?s("img",{attrs:{src:t.mchSrc}}):s("img",{attrs:{src:o("Q2SH")}})]),t._v(" "),s("div",{staticClass:"member-head-text"},[s("span",{staticClass:"text-small text-white"},[t._v(t._s(t.memberDetail.mchName))]),t._v(" "),s("span",[s("span",{staticClass:"text-yellow iconfont member-icon-vip"}),t._v(" "),s("span",{staticClass:"text-ssm text-white"},[t._v(t._s(t.memberDetail.memberCardName))])])])]),t._v(" "),s("div",[s("span",{staticClass:"text-small member-card-text"},[t._v("会员卡号")]),t._v(" "),s("div",{staticClass:"margin-top-10"},[s("span",{staticClass:"text-white text-weight text-letter"},[t._v(t._s(t.memberDetail.memberNo?t.memberDetail.memberNo:"88** **** ****"))])])])])]),t._v(" "),s("div",{staticClass:"member-space-around margin-top",style:{height:120*t.htmlProportion+"px"}},[s("div",{staticClass:"member-space-around-three"},[s("span",{staticClass:"text-gray"},[t._v("余额")]),t._v(" "),s("span",{staticClass:"text-blue text-mid-size"},[t._v(t._s(t.memberDetail.balance))])]),t._v(" "),s("div",{staticClass:"columnLine"}),t._v(" "),s("div",{staticClass:"member-space-around-three"},[s("span",{staticClass:"text-gray"},[t._v("可用积分")]),t._v(" "),s("span",{staticClass:"text-blue text-mid-size"},[t._v(t._s(t.memberDetail.point))])]),t._v(" "),s("div",{staticClass:"columnLine"}),t._v(" "),s("div",{staticClass:"member-space-around-three"},[s("span",{staticClass:"text-gray"},[t._v("优惠券")]),t._v(" "),s("span",{staticClass:"text-blue text-mid-size"},[t._v(t._s(t.memberDetail.couponCount))])])]),t._v(" "),s("div",{staticClass:"member-space-around margin-top",style:{height:120*t.htmlProportion+"px"}},[s("div",{staticClass:"member-flex-row"},[s("div",{staticClass:"margin-image margin-right-10"},[s("img",{style:{height:80*t.htmlProportion+"px"},attrs:{src:t.pay}})]),t._v(" "),s("div",{staticClass:"member-space-around-two",on:{click:function(e){return t.jump()}}},[s("span",{staticClass:"text-B text-small"},[t._v("会员付款码")]),t._v(" "),s("span",{staticClass:"text-gray text-s-small"},[t._v("出示付款码付款")])])]),t._v(" "),s("div",{staticClass:"member-flex-row"},[s("div",{staticClass:"margin-image margin-right-10"},[s("img",{style:{height:80*t.htmlProportion+"px"},attrs:{src:t.recharge}})]),t._v(" "),s("div",{staticClass:"member-space-around-two",on:{click:function(e){return t.jump()}}},[s("span",{staticClass:"text-B text-small"},[t._v("会员充值")]),t._v(" "),s("span",{staticClass:"text-gray text-s-small"},[t._v("充值享优惠")])])])])]),t._v(" "),s("mu-container",{staticStyle:{padding:"0 0 56px 0","margin-top":"10px"}},[s("mu-tabs",{attrs:{value:t.active,inverse:"",color:"black","indicator-color":"blue","full-width":""},on:{"update:value":function(e){t.active=e},change:t.change}},[s("mu-tab",[t._v("卡券广场")]),t._v(" "),s("mu-tab",[t._v("积分商城")])],1),t._v(" "),0===t.active?s("div",[s("mu-container",{ref:"container"},[s("mu-load-more",{attrs:{refreshing:t.couponRefreshing,loading:t.couponLoading,"loaded-all":t.couponLoadedAll},on:{refresh:t.couponRefresh,load:t.couponLoad}},[s("mu-list",[t._l(t.couponList,function(e,o){return[s("div",{key:o,staticClass:"coupon-item"},[s("div",{staticClass:"coupon-detail"},[s("div",{staticClass:"coupon-money"},[s("span",{staticClass:"text-B text-mid-big"},[t._v(t._s(e.couponAmount))]),t._v(" "),s("span",{staticClass:"text-black text-B"},[t._v("  "+t._s(e.payAmountLimit))])]),t._v(" "),s("div",{staticClass:"coupon-endTime"},[t._v(t._s(e.validateEnd))])]),t._v(" "),s("div",{staticClass:"coupon-get"},[s("div",{staticClass:"text-black"},[t._v(t._s(e.totalNum))]),t._v(" "),s("mu-button",{staticStyle:{transform:"scale(0.8)","font-size":"15px"},attrs:{small:"",round:"",color:"#FF9000"},on:{click:function(e){return t.getCoupon(o)}}},[t._v("立即抢")])],1)])]})],2)],1)],1)],1):t._e(),t._v(" "),1===t.active?s("div",[s("mu-container",{ref:"container"},[s("mu-load-more",{attrs:{refreshing:t.goodsRefreshing,loading:t.goodsLoading,"loaded-all":t.goodsLoadedAll},on:{refresh:t.goodsRefresh,load:t.goodsLoad}},[s("mu-list",[t._l(t.goodsList,function(e,o){return[s("div",{key:o,staticClass:"coupon-item"},[s("div",{staticClass:"coupon-detail"},[s("div",{staticClass:"coupon-money"},[s("span",{staticClass:"text-B text-mid text-black"},[t._v(t._s(e.goodsName))])]),t._v(" "),s("div",{staticClass:"coupon-money"},[s("span",{staticClass:"text-B"},[t._v(t._s(e.points))]),t._v(" "),s("span",{staticClass:"text-B"},[t._v("  "+t._s(e.goodsPrice))])]),t._v(" "),s("div",{staticClass:"coupon-endTime"},[t._v(t._s(e.validateEnd))])]),t._v(" "),s("div",{staticClass:"coupon-get"},[s("div",{staticClass:"text-black"},[t._v(t._s(e.stockNum))]),t._v(" "),s("mu-button",{staticStyle:{transform:"scale(0.8)","font-size":"15px","margin-top":"10px"},attrs:{small:"",round:"",color:"#FF9000"},on:{click:function(e){return t.getGoods(o)}}},[t._v("立即兑")])],1)])]})],2)],1)],1)],1):t._e()],1),t._v(" "),s("mu-container",{staticClass:"footerBox"},[s("mu-bottom-nav",{attrs:{value:"order"}},[s("mu-bottom-nav-item",{attrs:{title:"首页",icon:"home",value:"member",to:"/member",replace:""}}),t._v(" "),s("mu-bottom-nav-item",{attrs:{title:"订单",icon:"content_copy",value:"order",to:"/order",replace:""}}),t._v(" "),s("mu-bottom-nav-item",{attrs:{title:"我的",icon:"person",value:"user",to:"/user",replace:""}})],1)],1)],1)])])},staticRenderFns:[]};var h=o("C7Lr")(u,g,!1,function(t){o("F2Wx")},null,null);e.default=h.exports},"so+s":function(t,e,o){t.exports=o.p+"static/img/bg_card.e242211.png"}});